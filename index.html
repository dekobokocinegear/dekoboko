<!doctype html>
<html lang="ko">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1, viewport-fit=cover" />
<title>웹 슬레이트 (Scene / Cut / Take) – Adaptive Fullscreen + 모드 토글</title>
<style>
  :root{
    --line:#fff;
    --board:#000;
    --label:#fff;
    --value:#fff;
    --btn-bg:transparent;
    --btn-border:var(--line);
    --btn-text:var(--label);
    --focus-ring:rgba(127,127,127,.45);
    --meta-h:96px;
  }
  .theme-invert{
    --line:#000;
    --board:#fff;
    --label:#000;
    --value:#000;
    --btn-bg:transparent;
    --btn-border:var(--line);
    --btn-text:var(--label);
    --focus-ring:rgba(0,0,0,.35);
  }

  *{box-sizing:border-box}
  body{margin:0; background:var(--board); color:var(--label);
    font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Apple SD Gothic Neo,Noto Sans KR,Helvetica,Arial,sans-serif; height:100svh; overflow:hidden;}
  /* URL/툴바 변화 대응: 고정 스테이지 */
  .wrap{position:fixed; inset:0; width:100svw; height:100svh; display:flex; justify-content:center; align-items:center; padding:env(safe-area-inset-top,0) env(safe-area-inset-right,0) env(safe-area-inset-bottom,0) env(safe-area-inset-left,0);}
  .slate{ background:var(--board); width:920px; height:600px; border-radius:12px; box-shadow:0 12px 40px rgba(0,0,0,.25); border:1px solid rgba(127,127,127,.35); overflow:hidden; transform-origin:0 0; }

  .top{display:flex; align-items:center; justify-content:space-between; gap:12px; padding:18px 22px 12px; border-bottom:3px solid var(--line); font-weight:800; color:var(--label); letter-spacing:.02em;}
  .brandToggle{ text-decoration:none; color:var(--btn-text); display:inline-block; padding:6px 10px; border:2px solid var(--btn-border); border-radius:10px; }
  .controls{ display:flex; gap:8px; align-items:center; }
  .themeBtn,.smallBtn{appearance:none; border:2px solid var(--btn-border); background:var(--btn-bg); color:var(--btn-text); padding:6px 10px; border-radius:10px; font-weight:800; cursor:pointer; line-height:1; white-space:nowrap;}
  .themeBtn:focus-visible,.smallBtn:focus-visible{ outline:3px solid var(--focus-ring); outline-offset:2px; }

  .meta{ display:grid; grid-template-columns: 1fr 1fr 1fr; gap:0; border-bottom:3px solid var(--line); }
  .meta .row{ display:flex; flex-direction:column; justify-content:stretch; padding:10px 12px; height:var(--meta-h); }
  .meta label{ font:800 9px/1 var(--label); letter-spacing:.08em; margin-bottom:6px }
  .meta input{ flex:1; min-width:0; background:transparent; color:var(--label); border:none; border-radius:0; font-size:16px; font-weight:800; padding:18px 0px; height:calc(var(--meta-h) - 36px); line-height:1.2; }

  .grid{ display:grid; grid-template-columns: repeat(3, 1fr); gap:0; }
  .cell{ padding:18px 18px 22px; border-right:3px solid var(--line); border-bottom:3px solid var(--line); min-height:148px; display:flex; flex-direction:column; gap:12px; align-items:center; }
  .cell:last-child{border-right:none;}

  .label{ font-size:28px; font-weight:900; color:var(--label); letter-spacing:.12em; }
  .valueBox{ display:flex; flex-direction:column; align-items:center; gap:10px; }
  .value{ border:none; border-radius:0; padding:20px 14px; min-width:140px; text-align:center; font-weight:900; font-size:96px; line-height:1; color:var(--value); user-select:none; cursor:pointer; outline:none; }

  .btnRow{ display:flex; align-items:center; justify-content:center; gap:12px; }
  .btn{ appearance:none; border:none; background:var(--btn-bg); color:var(--btn-text); width:56px; height:56px; border-radius:12px; font-size:28px; font-weight:900; cursor:pointer; touch-action:manipulation; }

  @media (max-width:700px){
    .grid{ grid-template-columns:1fr; }
    .cell{ border-right:none; }
    .label{ font-size:22px; }
    .value{ font-size:72px; }
    .meta{ grid-template-columns:1fr; }
    .meta .row{ border-bottom:3px solid var(--line); }
    .meta .row:last-child{ border-bottom:none; }
  }
</style>
</head>
<body>
  <div class="wrap">
    <section class="slate" aria-label="영화 촬영 슬레이트">
      <div class="top">
        <a class="brandToggle" href="https://smartstore.naver.com/dekoboko" target="_blank" rel="noopener">DEKOBOKO</a>
        <div class="controls">
          <button class="smallBtn" id="resetCounts">↺ 리셋</button>
          <button class="themeBtn" id="themeToggle" aria-pressed="false">◐ 색상반전</button>
          <button class="themeBtn" id="scaleToggle" aria-pressed="false">⬒ 꽉채움</button>
        </div>
      </div>

      <div class="meta">
        <div class="row">
          <label for="director">DIRECTOR</label>
          <input id="director" placeholder="감독 이름" />
        </div>
        <div class="row">
          <label for="prod">PRODUCTION / NOTE</label>
          <input id="prod" placeholder="작품명 또는 메모" />
        </div>
        <div class="row">
          <label for="date">DATE</label>
          <input id="date" type="date" />
        </div>
      </div>

      <div class="grid">
        <div class="cell"><div class="label">SCENE</div><div class="valueBox"><div class="value" id="scene">1</div><div class="btnRow"><button class="btn" data-target="scene" data-step="-1">−</button><button class="btn" data-target="scene" data-step="1">+</button></div></div></div>
        <div class="cell"><div class="label">CUT</div><div class="valueBox"><div class="value" id="cut">1</div><div class="btnRow"><button class="btn" data-target="cut" data-step="-1">−</button><button class="btn" data-target="cut" data-step="1">+</button></div></div></div>
        <div class="cell"><div class="label">TAKE</div><div class="valueBox"><div class="value" id="take">1</div><div class="btnRow"><button class="btn" data-target="take" data-step="-1">−</button><button class="btn" data-target="take" data-step="1">+</button></div></div></div>
      </div>
    </section>
  </div>

<script>
(function(){
  const slate=document.querySelector('.slate');
  const scaleBtn=document.getElementById('scaleToggle');

  const BASE_W=920, BASE_H=600;

  function metrics(){
    // iOS Safari URL/툴바 변화를 반영하는 작은 뷰포트 기준 사용
    const vw = (window.visualViewport? visualViewport.width : window.innerWidth);
    const vh = (window.visualViewport? visualViewport.height: window.innerHeight);
    return {vw, vh};
  }

  function applyScale(){
    const {vw, vh} = metrics();
    const stretch = document.body.classList.contains('stretch-mode');

    if(stretch){
      // 가로/세로 독립 스케일 + 중앙 정렬 보정 (클리핑 방지)
      const sx = vw / BASE_W; const sy = vh / BASE_H;
      const tx = (vw - BASE_W * sx) / 2;  // 남는 영역을 절반씩 분배
      const ty = (vh - BASE_H * sy) / 2;
      slate.style.transform = `translate(${tx}px, ${ty}px) scale(${sx}, ${sy})`;
    }else{
      // 비율 유지 스케일 + 중앙 정렬
      const s  = Math.min(vw / BASE_W, vh / BASE_H);
      const tx = (vw - BASE_W * s) / 2;
      const ty = (vh - BASE_H * s) / 2;
      slate.style.transform = `translate(${tx}px, ${ty}px) scale(${s})`;
    }
  }

  function rafApply(){ cancelAnimationFrame(rafApply._id); rafApply._id = requestAnimationFrame(applyScale); }

  ['resize','orientationchange'].forEach(ev=> window.addEventListener(ev, rafApply));
  if(window.visualViewport){ ['resize','scroll'].forEach(ev=> visualViewport.addEventListener(ev, rafApply)); }

  // 토글 버튼: 모드 전환(꽉채움 ↔ 비율유지)
  scaleBtn && scaleBtn.addEventListener('click', ()=>{
    const stretch=document.body.classList.toggle('stretch-mode');
    scaleBtn.textContent = stretch ? '⬒ 비율유지' : '⬒ 꽉채움';
    rafApply();
  });

  // 초기 적용 (연속 2회로 iOS 레이아웃 지연 보정)
  rafApply();
  setTimeout(rafApply, 50);
})();
</script>
</body>
</html>
